<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Face Similarity Checker</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-200 min-h-screen flex items-center justify-center">
  <div class="max-w-xl w-full p-6 bg-gray-800 rounded-2xl shadow-lg text-center border border-gray-700">
    <h1 class="text-3xl font-bold mb-6 bg-gradient-to-r from-indigo-500 to-pink-500 bg-clip-text text-transparent">
      Face Similarity Checker
    </h1>

    <div class="grid grid-cols-2 gap-4 mb-4">
      <div>
        <label class="block mb-1 font-semibold text-indigo-300">Image 1</label>
        <input type="file" id="image1" accept="image/*" class="mb-2 w-full bg-gray-700 text-white rounded px-2 py-1 cursor-pointer" />
        <img id="preview1" class="mx-auto h-40 object-cover rounded-lg border border-indigo-500 transition-transform duration-300 hover:scale-105 hover:shadow-lg" />
      </div>
      <div>
        <label class="block mb-1 font-semibold text-pink-300">Image 2</label>
        <input type="file" id="image2" accept="image/*" class="mb-2 w-full bg-gray-700 text-white rounded px-2 py-1 cursor-pointer" />
        <img id="preview2" class="mx-auto h-40 object-cover rounded-lg border border-pink-500 transition-transform duration-300 hover:scale-105 hover:shadow-lg" />
      </div>
    </div>

    <button id="predictBtn" onclick="predict()" class="bg-gradient-to-r from-indigo-500 to-pink-500 text-white px-6 py-2 rounded-xl font-semibold hover:scale-105 transition duration-300 inline-flex items-center justify-center">
      <span id="predictText">Predict</span>
      <svg id="loadingSpinner" class="hidden w-5 h-5 ml-2 animate-spin text-white" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
      </svg>
    </button>

    <div id="result" class="mt-6 text-xl font-semibold text-yellow-300"></div>
  </div>

  <script>
    const image1 = document.getElementById('image1');
    const image2 = document.getElementById('image2');
    const preview1 = document.getElementById('preview1');
    const preview2 = document.getElementById('preview2');
    const predictBtn = document.getElementById('predictBtn');
    const predictText = document.getElementById('predictText');
    const spinner = document.getElementById('loadingSpinner');

    image1.onchange = () => {
      const [file] = image1.files;
      if (file) preview1.src = URL.createObjectURL(file);
    };

    image2.onchange = () => {
      const [file] = image2.files;
      if (file) preview2.src = URL.createObjectURL(file);
    };

    function predict() {
      if (!image1.files.length || !image2.files.length) {
        alert("Please load both images.");
        return;
      }

      const formData = new FormData();
      formData.append('image1', image1.files[0]);
      formData.append('image2', image2.files[0]);

      predictText.textContent = "Processing...";
      spinner.classList.remove("hidden");
      predictBtn.disabled = true;

      fetch('/predict', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json())
      .then(data => {
        if (data.verified !== undefined) {
          document.getElementById('result').innerText =
            data.verified ? `✅ Match (distance: ${data.distance.toFixed(2)})` : `❌ No Match (distance: ${data.distance.toFixed(2)})`;
        } else {
          document.getElementById('result').innerText = 'Error: ' + data.error;
        }
      })
      .catch(() => {
        document.getElementById('result').innerText = '❌ Prediction failed.';
      })
      .finally(() => {
        predictText.textContent = "Predict";
        spinner.classList.add("hidden");
        predictBtn.disabled = false;
      });
    }
  </script>
</body>
</html>
